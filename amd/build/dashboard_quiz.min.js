define ("local_assessfreq/dashboard_quiz",["local_assessfreq/form_modal","core/ajax","core/notification","core/str","core/fragment","core/templates"],function(a,b,c,d,e,f){var g={},h="",i,j=0,k=[{cardId:"local-assessfreq-quiz-summary-graph",call:"participant_summary"},{cardId:"local-assessfreq-quiz-summary-trend",call:"participant_trend"}],l=function(){k.forEach(function(a){var b=document.getElementById(a.cardId),d=b.getElementsByClassName("overlay-icon-container")[0],g=b.getElementsByClassName("chart-body")[0],h={data:JSON.stringify({quiz:j,call:a.call})};d.classList.remove("hide");e.loadFragment("local_assessfreq","get_quiz_chart",i,h).done(function(a){f.render("core/chart",{withtable:!0,chartdata:a}).done(function(a,b){d.classList.add("hide");f.replaceNodeContents(g,a,b)}).fail(function(){c.exception(new Error("Failed to load chart template."))})}).fail(function(){c.exception(new Error("Failed to load card."))})})},m=function(a){a.preventDefault();var b=a.target.dataset.sortby,c=a.target.dataset.sortorder;window.console.log(b);window.console.log(c)},n=function(a){a.preventDefault();for(var b=[],c=document.getElementById("local-assessfreq-quiz-table"),d=a.target.closest("a").dataset.action,e=a.target.closest("a").dataset.column,f=c.querySelectorAll("[data-action]"),g=0;g<f.length;g++){var h=f[g].dataset.action,j=f[g].dataset.column;b[j]="hide"===h?1:0}b[e]="hide"===d?0:1;window.console.log(b)},o=function(){for(var a=document.getElementById("local-assessfreq-quiz-table"),b=a.querySelectorAll("[data-sortable=\"1\"]"),c=a.querySelectorAll("[data-action]"),d=0;d<b.length;d++){b[d].addEventListener("click",m)}for(var e=0;e<c.length;e++){c[e].addEventListener("click",n)}},p=function(){var a=document.getElementById("local-assessfreq-quiz-table"),b=a.getElementsByClassName("overlay-icon-container")[0],d=a.getElementsByClassName("table-body")[0],f={data:JSON.stringify({quiz:j})};b.classList.remove("hide");e.loadFragment("local_assessfreq","get_student_table",i,f).done(function(a){d.innerHTML=a;b.classList.add("hide");o()}).fail(function(){c.exception(new Error("Failed to update table."))})},q=function(a){j=a;var d=document.getElementById("local-assessfreq-quiz-title");d.innerHTML=h;b.call([{methodname:"local_assessfreq_get_quiz_data",args:{quizid:a}}])[0].then(function(a){var b=JSON.parse(a),c=document.getElementById("local-assessfreq-quiz-dashboard-cards-deck"),e=document.getElementById("local-assessfreq-quiz-dashboard-participant-trend-deck"),f=document.getElementById("local-assessfreq-quiz-summary-card"),g=f.getElementsByClassName("overlay-icon-container")[0],h=document.getElementById("local-assessfreq-quiz-table");d.innerHTML=b.name;var i=new URL(window.location.href),k=i.origin+i.pathname+"?id="+j;history.pushState({},"",k);document.getElementById("quiz-time-open").innerHTML=b.timeopen;document.getElementById("quiz-time-close").innerHTML=b.timeclose;document.getElementById("quiz-time-limit").innerHTML=b.timelimit;document.getElementById("quiz-time-earlyopen").innerHTML=b.earlyopen;document.getElementById("quiz-time-lateclose").innerHTML=b.lateclose;document.getElementById("quiz-participants").innerHTML=b.participants;document.getElementById("quiz-participants-override").innerHTML=b.overrideparticipants;document.getElementById("quiz-question-number").innerHTML=b.questioncount;document.getElementById("quiz-question-types").innerHTML=b.typecount;c.classList.remove("hide");e.classList.remove("hide");h.classList.remove("hide");g.classList.add("hide");l();p();window.console.log(b)}).fail(function(){c.exception(new Error("Failed to get quiz data"))})};g.init=function(b,e){i=b;a.init(b,q);d.get_string("loadingquiztitle","local_assessfreq").then(function(a){h=a}).catch(function(){c.exception(new Error("Failed to load string: loadingquiz"))}).then(function(){if(0<e){j=e;q(e)}})};return g});
//# sourceMappingURL=dashboard_quiz.min.js.map
