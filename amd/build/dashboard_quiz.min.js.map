{"version":3,"sources":["../src/dashboard_quiz.js"],"names":["define","FormModal","Ajax","Notification","Str","Fragment","Templates","ZoomModal","OverrideModal","DashboardQuiz","selectQuizStr","contextid","quizId","refreshPeriod","counterid","cards","cardId","call","aspect","refreshCounter","reset","progressElement","document","getElementById","clearInterval","setAttribute","setInterval","progressWidthAria","getAttribute","progressStep","processDashboard","getCardCharts","forEach","cardData","cardElement","spinner","getElementsByClassName","chartbody","params","JSON","stringify","classList","remove","loadFragment","done","response","resObj","parse","hasdata","context","chart","render","html","js","add","replaceNodeContents","fail","exception","Error","get_string","then","str","noDatastr","createElement","innerHTML","outerHTML","catch","tableSort","event","preventDefault","sortArray","targetSortBy","target","dataset","sortby","targetSortOrder","sortorder","methodname","args","tableid","preference","values","getStudentTable","tableHide","hideArray","tableElement","targetAction","closest","action","targetColumn","column","hideLinks","querySelectorAll","i","length","tableReset","tableSearch","value","tableSearchReset","tableSearchInputElement","focus","tableEventListeners","sortLinks","resetlink","overrideLinks","disabledLinks","addEventListener","triggerOverrideModal","search","tableBody","quiz","titleElement","quizid","quizArray","cardsElement","trendElement","summaryElement","summarySpinner","periodElement","tableSearchResetElement","quizLink","href","url","name","appendChild","currentdUrl","URL","window","location","newUrl","origin","pathname","history","pushState","timeopen","timeclose","timelimit","earlyopen","lateclose","participants","overrideparticipants","questioncount","typecount","refreshAction","element","id","tagName","toLowerCase","period","triggerZoomGraph","parentElement","zoomGraph","userid","substring","displayModalForm","init","refreshElement","summaryZoom","trendZoom"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript for report card display and processing.\n *\n * @package    local_assessfreq\n * @copyright  2020 Matt Porritt <mattp@catalyst-au.net>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['local_assessfreq/form_modal', 'core/ajax', 'core/notification', 'core/str', 'core/fragment', 'core/templates',\n    'local_assessfreq/zoom_modal', 'local_assessfreq/override_modal'],\nfunction(FormModal, Ajax, Notification, Str, Fragment, Templates, ZoomModal, OverrideModal) {\n\n    /**\n     * Module level variables.\n     */\n    var DashboardQuiz = {};\n    var selectQuizStr = '';\n    var contextid;\n    var quizId = 0;\n    var refreshPeriod = 60;\n    var counterid;\n\n    const cards = [\n        {cardId: 'local-assessfreq-quiz-summary-graph', call: 'participant_summary', aspect: true},\n        {cardId: 'local-assessfreq-quiz-summary-trend', call: 'participant_trend', aspect: false}\n    ];\n\n    /**\n     *\n     */\n    const refreshCounter = function(reset) {\n        let progressElement = document.getElementById('local-assessfreq-period-progress');\n\n        // Reset the current count process.\n        if (reset == true) {\n            clearInterval(counterid);\n            counterid = null;\n            progressElement.setAttribute('style', 'width: 100%');\n            progressElement.setAttribute('aria-valuenow', 100);\n        }\n\n        // Exit early if there is already a counter running.\n        if (counterid) {\n            return;\n        }\n\n        counterid = setInterval(() => {\n            let progressWidthAria = progressElement.getAttribute('aria-valuenow');\n            const progressStep = 100 / refreshPeriod;\n\n            if ((progressWidthAria - progressStep) > 0) {\n                progressElement.setAttribute('style', 'width: ' + (progressWidthAria - progressStep) + '%');\n                progressElement.setAttribute('aria-valuenow', (progressWidthAria - progressStep));\n            } else {\n                clearInterval(counterid);\n                counterid = null;\n                progressElement.setAttribute('style', 'width: 100%');\n                progressElement.setAttribute('aria-valuenow', 100);\n                processDashboard(quizId);\n                refreshCounter();\n            }\n        }, (1000));\n    };\n\n    /**\n     * For each of the cards on the dashbaord get their corresponding chart data.\n     * Data is based on the year variable from the corresponding dropdown.\n     * Chart data is loaded via ajax.\n     *\n     */\n    const getCardCharts = function() {\n        cards.forEach((cardData) => {\n            let cardElement = document.getElementById(cardData.cardId);\n            let spinner = cardElement.getElementsByClassName('overlay-icon-container')[0];\n            let chartbody = cardElement.getElementsByClassName('chart-body')[0];\n            let params = {'data': JSON.stringify({'quiz' : quizId, 'call': cardData.call})};\n\n            spinner.classList.remove('hide'); // Show sinner if not already shown.\n            Fragment.loadFragment('local_assessfreq', 'get_quiz_chart', contextid, params)\n            .done((response) => {\n                let resObj = JSON.parse(response);\n                if (resObj.hasdata == true) {\n                    let context = { 'withtable' : true, 'chartdata' : JSON.stringify(resObj.chart), 'aspect' :  cardData.aspect};\n                    Templates.render('local_assessfreq/chart', context).done((html, js) => {\n                        spinner.classList.add('hide'); // Hide spinner if not already hidden.\n                        // Load card body.\n                        Templates.replaceNodeContents(chartbody, html, js);\n                    }).fail(() => {\n                        Notification.exception(new Error('Failed to load chart template.'));\n                        return;\n                    });\n                    return;\n                } else {\n                    Str.get_string('nodata', 'local_assessfreq').then((str) => {\n                        const noDatastr = document.createElement('h3');\n                        noDatastr.innerHTML = str;\n                        chartbody.innerHTML = noDatastr.outerHTML;\n                        spinner.classList.add('hide'); // Hide spinner if not already hidden.\n                        return;\n                    }).catch(() => {\n                        Notification.exception(new Error('Failed to load string: nodata'));\n                    });\n                }\n            }).fail(() => {\n                Notification.exception(new Error('Failed to load card.'));\n                return;\n            });\n        });\n    };\n\n    /**\n     * Process the sort click events from the student table.\n     */\n    const tableSort = function(event) {\n        event.preventDefault();\n\n        let sortArray = {};\n        const targetSortBy = event.target.dataset.sortby;\n        let targetSortOrder = event.target.dataset.sortorder;\n\n        // We want to flip the clicked column.\n        if (targetSortOrder === '') {\n            targetSortOrder = \"4\";\n        }\n\n        sortArray[targetSortBy] = targetSortOrder;\n\n        // Set option via ajax.\n        Ajax.call([{\n            methodname: 'local_assessfreq_set_table_preference',\n            args: {\n                tableid: 'local_assessfreq_student_table',\n                preference: 'sortby',\n                values: JSON.stringify(sortArray)\n            },\n        }])[0].then(() => {\n            getStudentTable(); // Reload the table.\n        });\n\n    };\n\n    /**\n     * Process the sort click events from the student table.\n     */\n    const tableHide = function(event) {\n        event.preventDefault();\n\n        let hideArray = {};\n        const tableElement = document.getElementById('local-assessfreq-quiz-table');\n        const targetAction = event.target.closest('a').dataset.action;\n        const targetColumn = event.target.closest('a').dataset.column;\n\n        const hideLinks = tableElement.querySelectorAll('[data-action]');\n        for (let i = 0; i < hideLinks.length; i++) {\n            let action = hideLinks[i].dataset.action;\n            let column = hideLinks[i].dataset.column;\n\n            if (action === 'show') {\n                hideArray[column] = 1;\n            }\n        }\n\n        hideArray[targetColumn] = (targetAction === 'hide') ? 1 : 0; // We want to flip the clicked column.\n\n        // Set option via ajax.\n        Ajax.call([{\n            methodname: 'local_assessfreq_set_table_preference',\n            args: {\n                tableid: 'local_assessfreq_student_table',\n                preference: 'collapse',\n                values: JSON.stringify(hideArray)\n            },\n        }])[0].then(() => {\n            getStudentTable(); // Reload the table.\n        });\n\n    };\n\n    /**\n     * Process the reset click event from the student table.\n     */\n    const tableReset = function(event) {\n        event.preventDefault();\n\n        // Set option via ajax.\n        Ajax.call([{\n            methodname: 'local_assessfreq_set_table_preference',\n            args: {\n                tableid: 'local_assessfreq_student_table',\n                preference: 'reset',\n                values: JSON.stringify({})\n            },\n        }])[0].then(() => {\n            getStudentTable(); // Reload the table.\n        });\n\n    };\n\n    /**\n     * Process the search events from the student table.\n     */\n    const tableSearch = function(event) {\n         if (event.target.value.length > 2) {\n            getStudentTable(event.target.value);\n         }\n\n         if (event.target.value.length == 0) {\n             getStudentTable();\n          }\n    };\n\n    /**\n     * Process the search reset click event from the student table.\n     */\n    const tableSearchReset = function() {\n        let tableSearchInputElement = document.getElementById('local-assessfreq-quiz-student-table-search');\n        tableSearchInputElement.value = '';\n        tableSearchInputElement.focus();\n        getStudentTable();\n    };\n\n    /**\n     * Re-add event listeners when the student table is updated.\n     */\n    const tableEventListeners = function() {\n        const tableElement = document.getElementById('local-assessfreq-quiz-table');\n        const sortLinks = tableElement.querySelectorAll(`[data-sortable=\"1\"]`);\n        const hideLinks = tableElement.querySelectorAll('[data-action]');\n        const resetlink = tableElement.getElementsByClassName('resettable');\n        const overrideLinks = tableElement.getElementsByClassName('action-icon override');\n        const disabledLinks = tableElement.getElementsByClassName('action-icon disabled');\n\n        for (let i = 0; i < sortLinks.length; i++) {\n            sortLinks[i].addEventListener('click', tableSort);\n        }\n\n        for (let i = 0; i < hideLinks.length; i++) {\n            hideLinks[i].addEventListener('click', tableHide);\n        }\n\n        if (resetlink.length > 0) {\n            resetlink[0].addEventListener('click', tableReset);\n        }\n\n        for (let i = 0; i < overrideLinks.length; i++) {\n            overrideLinks[i].addEventListener('click', triggerOverrideModal);\n        }\n\n        for (let i = 0; i < disabledLinks.length; i++) {\n            disabledLinks[i].addEventListener('click', (event) => {\n                event.preventDefault();\n            });\n        }\n    };\n\n    /**\n     * Display the table that contains all the students in the exam as well as their attempts.\n     */\n    const getStudentTable = function(search) {\n        if (typeof search === \"undefined\") {\n            search = '';\n        }\n\n        let tableElement = document.getElementById('local-assessfreq-quiz-table');\n        let spinner = tableElement.getElementsByClassName('overlay-icon-container')[0];\n        let tableBody = tableElement.getElementsByClassName('table-body')[0];\n        let params = {'data': JSON.stringify({'quiz' : quizId, 'search': search})};\n\n        spinner.classList.remove('hide'); // Show spinner if not already shown.\n        Fragment.loadFragment('local_assessfreq', 'get_student_table', contextid, params)\n        .done((response) => {\n            tableBody.innerHTML = response;\n            spinner.classList.add('hide');\n            tableEventListeners(); // Re-add table event listeners.\n\n        }).fail(() => {\n            Notification.exception(new Error('Failed to update table.'));\n        });\n    };\n\n    /**\n     * Callback function that is called when a quiz is selected from the form.\n     * Starts the processing of the dashbaord.\n     */\n    const processDashboard = function(quiz) {\n        quizId = quiz;\n        let titleElement = document.getElementById('local-assessfreq-quiz-title');\n        titleElement.innerHTML = selectQuizStr;\n        // Get quiz data.\n        Ajax.call([{\n            methodname: 'local_assessfreq_get_quiz_data',\n            args: {\n                quizid: quiz\n            },\n        }])[0].then((response) => {\n\n            let quizArray = JSON.parse(response);\n            let cardsElement = document.getElementById('local-assessfreq-quiz-dashboard-cards-deck');\n            let trendElement = document.getElementById('local-assessfreq-quiz-dashboard-participant-trend-deck');\n            let summaryElement = document.getElementById('local-assessfreq-quiz-summary-card');\n            let summarySpinner = summaryElement.getElementsByClassName('overlay-icon-container')[0];\n            let tableElement = document.getElementById('local-assessfreq-quiz-table');\n            let periodElement = document.getElementById('local-assessfreq-period-container');\n            let tableSearchInputElement = document.getElementById('local-assessfreq-quiz-student-table-search');\n            let tableSearchResetElement = document.getElementById('local-assessfreq-quiz-student-table-search-reset');\n\n            let quizLink = document.createElement('a');\n            quizLink.href = quizArray.url;\n            quizLink.innerHTML = '<i class=\"fa fa-link fa-flip-vertical fa-fw\"></i>';\n            titleElement.innerHTML = quizArray.name + '&nbsp;';\n            titleElement.appendChild(quizLink);\n\n            // Update page URL with quiz ID, without reloading page so that page navigation and bookmarking works.\n            const currentdUrl = new URL(window.location.href);\n            const newUrl = currentdUrl.origin + currentdUrl.pathname + '?id=' + quizId;\n            history.pushState({}, '', newUrl);\n\n            // Populate quiz summary card with details.\n            document.getElementById('quiz-time-open').innerHTML = quizArray.timeopen;\n            document.getElementById('quiz-time-close').innerHTML = quizArray.timeclose;\n            document.getElementById('quiz-time-limit').innerHTML = quizArray.timelimit;\n            document.getElementById('quiz-time-earlyopen').innerHTML = quizArray.earlyopen;\n            document.getElementById('quiz-time-lateclose').innerHTML = quizArray.lateclose;\n            document.getElementById('quiz-participants').innerHTML = quizArray.participants;\n            document.getElementById('quiz-participants-override').innerHTML = quizArray.overrideparticipants;\n            document.getElementById('quiz-question-number').innerHTML = quizArray.questioncount;\n            document.getElementById('quiz-question-types').innerHTML = quizArray.typecount;\n\n            // Show the cards.\n            cardsElement.classList.remove('hide');\n            trendElement.classList.remove('hide');\n            tableElement.classList.remove('hide');\n            periodElement.classList.remove('hide');\n            summarySpinner.classList.add('hide');\n            getCardCharts();\n            getStudentTable();\n            refreshCounter();\n\n            tableSearchInputElement.addEventListener('keyup', tableSearch);\n            tableSearchInputElement.addEventListener('paste', tableSearch);\n            tableSearchResetElement.addEventListener('click', tableSearchReset);\n            // TODO: Cancel autorefresh of cards while quiz in changing.\n\n            return;\n        }).fail(() => {\n            Notification.exception(new Error('Failed to get quiz data'));\n        });\n    };\n\n    /**\n     * Handle processing of refresh and period button actions.\n     */\n    const refreshAction = function(event) {\n        event.preventDefault();\n        var element = event.target;\n\n        if (element.closest('button') !== null && element.closest('button').id == 'local-assessfreq-refresh-quiz-dashboard') {\n          refreshCounter(true);\n          processDashboard(quizId);\n        } else if (element.tagName.toLowerCase() === 'a') {\n            refreshPeriod = element.dataset.period;\n            refreshCounter(true);\n        }\n    };\n\n    /**\n     * Trigger the zoom graph. Thin wrapper to add extra data to click event.\n     */\n    const triggerZoomGraph = function(event) {\n        let call = event.target.parentElement.dataset.call;\n        let params = {'data': JSON.stringify({'quiz' : quizId, 'call': call})};\n        let method = 'get_quiz_chart';\n\n        ZoomModal.zoomGraph(event, params, method);\n    };\n\n    /**\n     * Trigger the override modal form. Thin wrapper to add extra data to click event.\n     */\n    const triggerOverrideModal = function(event) {\n        event.preventDefault();\n        const userid = event.target.closest('a').id.substring(25);\n\n        OverrideModal.displayModalForm(quizId, userid);\n    };\n\n    /**\n     * Initialise method for quiz dashboard rendering.\n     */\n    DashboardQuiz.init = function(context, quiz) {\n        contextid = context;\n        FormModal.init(context, processDashboard); // Create modal for quiz selection modal.\n        ZoomModal.init(context); // Create the zoom modal.\n        OverrideModal.init(context, processDashboard);\n\n        Str.get_string('loadingquiztitle', 'local_assessfreq').then((str) => {\n            selectQuizStr = str;\n        }).catch(() => {\n            Notification.exception(new Error('Failed to load string: loadingquiz'));\n        }).then(() => {\n            if (quiz > 0) {\n                quizId = quiz;\n                processDashboard(quiz);\n            }\n        });\n\n        // Event handling for refresh and period buttons.\n        let refreshElement = document.getElementById('local-assessfreq-period-container');\n        refreshElement.addEventListener('click', refreshAction);\n\n        // Set up zoom event listeners.\n        let summaryZoom = document.getElementById('local-assessfreq-quiz-summary-graph-zoom');\n        summaryZoom.addEventListener('click', triggerZoomGraph);\n\n        let trendZoom = document.getElementById('local-assessfreq-quiz-summary-trend-zoom');\n        trendZoom.addEventListener('click', triggerZoomGraph);\n\n    };\n\n    return DashboardQuiz;\n});\n"],"file":"dashboard_quiz.min.js"}