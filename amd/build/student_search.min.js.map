{"version":3,"sources":["../src/student_search.js"],"names":["define","Ajax","Fragment","Notification","OverrideModal","StudentSearch","contextid","overridden","hoursAhead","hoursBehind","refreshPeriod","counterid","setUserPreference","type","value","call","methodname","args","preferences","debounceTable","debouncer","func","wait","timeout","later","clearTimeout","setTimeout","getStudentTable","refreshCounter","reset","progressElement","document","getElementById","clearInterval","setAttribute","setInterval","progressWidthAria","getAttribute","progressStep","tableSort","event","preventDefault","sortArray","linkUrl","URL","target","closest","href","targetSortBy","searchParams","get","targetSortOrder","tableid","preference","values","JSON","stringify","then","tableHide","hideArray","tableElement","links","querySelectorAll","targetAction","targetColumn","action","column","search","indexOf","i","hideLinkUrl","length","tableReset","tableSearch","key","ctrlKey","tableSearchReset","tableSearchInputElement","focus","tableSearchRowSet","tagName","toLowerCase","rows","dataset","metric","activeoptions","getElementsByClassName","classList","remove","add","fail","exception","Error","tableSearchAheadSet","hours","tableSearchBehindSet","tableNav","page","tableEventListeners","tableCardElement","resetlink","overrideLinks","disabledLinks","tableNavElement","addEventListener","triggerOverrideModal","forEach","navElement","trim","spinner","tableBody","params","loadFragment","done","response","innerHTML","refreshAction","element","id","refreshElement","actionButton","textContent","period","elements","split","quizId","pop","userid","displayModalForm","init","context","tableSearchResetElement","tableSearchRowsElement","tableSearchAheadElement","tableSearchBehindElement"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript for student search display and processing.\n *\n * @package    local_assessfreq\n * @copyright  2020 Matt Porritt <mattp@catalyst-au.net>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['core/ajax', 'core/fragment', 'core/notification', 'local_assessfreq/override_modal'],\nfunction(Ajax, Fragment, Notification, OverrideModal) {\n\n    /**\n     * Module level variables.\n     */\n    var StudentSearch = {};\n    var contextid;\n    var overridden = false;\n    var hoursAhead = 4;\n    var hoursBehind = 1;\n    var refreshPeriod = 60;\n    var counterid;\n\n    /**\n     * Generic handler to persist user preferences.\n     *\n     * @param {string} type The name of the attribute you're updating\n     * @param {string} value The value of the attribute you're updating\n     * @return {object} jQuery promise\n     */\n    const setUserPreference = function(type, value) {\n        var request = {\n            methodname: 'core_user_update_user_preferences',\n            args: {\n                preferences: [{type: type, value: value}]\n            }\n        };\n\n        return Ajax.call([request])[0];\n    };\n\n    /**\n     * Quick and dirty debounce method for the settings.\n     * This stops the ajax method that updates the table from being updated\n     * while the user is still checking options.\n     *\n     */\n    const debouncer = function (func, wait) {\n        let timeout;\n\n        return function executedFunction(...args) {\n            const later = () => {\n                clearTimeout(timeout);\n                func(...args);\n            };\n\n            clearTimeout(timeout);\n            timeout = setTimeout(later, wait);\n        };\n    };\n\n    const debounceTable = debouncer(() => {\n        getStudentTable();\n    }, 750);\n\n    /**\n    *\n    */\n    const refreshCounter = function(reset) {\n        let progressElement = document.getElementById('local-assessfreq-period-progress');\n\n        // Reset the current count process.\n        if (reset == true) {\n            clearInterval(counterid);\n            counterid = null;\n            progressElement.setAttribute('style', 'width: 100%');\n            progressElement.setAttribute('aria-valuenow', 100);\n        }\n\n        // Exit early if there is already a counter running.\n        if (counterid) {\n            return;\n        }\n\n        counterid = setInterval(() => {\n            let progressWidthAria = progressElement.getAttribute('aria-valuenow');\n            const progressStep = 100 / refreshPeriod;\n\n            if ((progressWidthAria - progressStep) > 0) {\n                progressElement.setAttribute('style', 'width: ' + (progressWidthAria - progressStep) + '%');\n                progressElement.setAttribute('aria-valuenow', (progressWidthAria - progressStep));\n            } else {\n                clearInterval(counterid);\n                counterid = null;\n                progressElement.setAttribute('style', 'width: 100%');\n                progressElement.setAttribute('aria-valuenow', 100);\n                getStudentTable();\n                refreshCounter();\n            }\n        }, (1000));\n    };\n\n    /**\n     * Process the sort click events from the student table.\n     */\n    const tableSort = function(event) {\n        event.preventDefault();\n\n        let sortArray = {};\n        const linkUrl = new URL(event.target.closest('a').href);\n        const targetSortBy = linkUrl.searchParams.get('tsort');\n        let targetSortOrder = linkUrl.searchParams.get('tdir');\n\n        // We want to flip the clicked column.\n        if (targetSortOrder === '') {\n            targetSortOrder = \"4\";\n        }\n\n        sortArray[targetSortBy] = targetSortOrder;\n\n        // Set option via ajax.\n        Ajax.call([{\n            methodname: 'local_assessfreq_set_table_preference',\n            args: {\n                tableid: 'local_assessfreq_student_search_table',\n                preference: 'sortby',\n                values: JSON.stringify(sortArray)\n            },\n        }])[0].then(() => {\n            getStudentTable(); // Reload the table.\n        });\n\n    };\n\n    /**\n     * Process the sort click events from the student table.\n     */\n    const tableHide = function(event) {\n        event.preventDefault();\n\n        let hideArray = {};\n        const linkUrl = new URL(event.target.closest('a').href);\n        const tableElement = document.getElementById('local-assessfreq-student-search');\n        const links = tableElement.querySelectorAll('a');\n        let targetAction;\n        let targetColumn;\n        let action;\n        let column;\n\n        if (linkUrl.search.indexOf('thide') !== -1) {\n            targetAction = 'hide';\n            targetColumn = linkUrl.searchParams.get('thide');\n        } else {\n            targetAction = 'show';\n            targetColumn = linkUrl.searchParams.get('tshow');\n        }\n\n        for (let i = 0; i < links.length; i++) {\n            let hideLinkUrl = new URL(links[i].href);\n            if (hideLinkUrl.search.indexOf('thide') !== -1) {\n                action = 'hide';\n                column = hideLinkUrl.searchParams.get('thide');\n            } else {\n                action = 'show';\n                column = hideLinkUrl.searchParams.get('tshow');\n            }\n\n            if (action === 'show') {\n                hideArray[column] = 1;\n            }\n\n        }\n\n        hideArray[targetColumn] = (targetAction === 'hide') ? 1 : 0; // We want to flip the clicked column.\n\n        // Set option via ajax.\n        Ajax.call([{\n            methodname: 'local_assessfreq_set_table_preference',\n            args: {\n                tableid: 'local_assessfreq_student_search_table',\n                preference: 'collapse',\n                values: JSON.stringify(hideArray)\n            },\n        }])[0].then(() => {\n            getStudentTable(); // Reload the table.\n        });\n\n    };\n\n    /**\n     * Process the reset click event from the student table.\n     */\n    const tableReset = function(event) {\n        event.preventDefault();\n\n        // Set option via ajax.\n        Ajax.call([{\n            methodname: 'local_assessfreq_set_table_preference',\n            args: {\n                tableid: 'local_assessfreq_student_search_table',\n                preference: 'reset',\n                values: JSON.stringify({})\n            },\n        }])[0].then(() => {\n            getStudentTable(); // Reload the table.\n        });\n\n    };\n\n    /**\n     * Process the search events from the student table.\n     */\n    const tableSearch = function(event) {\n        if (event.key === 'Meta' || event.ctrlKey) {\n            return false;\n        }\n\n        if (event.target.value.length === 0 || event.target.value.length > 2) {\n            debounceTable();\n        }\n    };\n\n    /**\n     * Process the search reset click event from the student table.\n     */\n    const tableSearchReset = function() {\n        let tableSearchInputElement = document.getElementById('local-assessfreq-quiz-student-table-search');\n        tableSearchInputElement.value = '';\n        tableSearchInputElement.focus();\n        getStudentTable();\n    };\n\n    /**\n     * Process the row set event from the student table.\n     */\n    const tableSearchRowSet = function(event) {\n        event.preventDefault();\n        if (event.target.tagName.toLowerCase() === 'a') {\n            let rows = event.target.dataset.metric;\n            let activeoptions = document.getElementById('local-assessfreq-quiz-student-table-rows')\n            .getElementsByClassName('active');\n\n            // Fix active classes.\n            for (var i = 0; i < activeoptions.length; i++) {\n                activeoptions[i].classList.remove('active');\n            }\n            event.target.classList.add('active');\n\n            setUserPreference('local_assessfreq_student_search_table_rows_preference', rows)\n            .then(() => {\n                getStudentTable(); // Reload the table.\n            })\n            .fail(() => {\n                Notification.exception(new Error('Failed to update user preference: rows'));\n            });\n        }\n    };\n\n    /**\n     * Process the hours ahead event from the student table.\n     */\n    const tableSearchAheadSet = function(event) {\n        event.preventDefault();\n        if (event.target.tagName.toLowerCase() === 'a') {\n            let hours = event.target.dataset.metric;\n            let activeoptions = document.getElementById('local-assessfreq-quiz-student-table-hoursahead')\n            .getElementsByClassName('active');\n\n            // Fix active classes.\n            for (var i = 0; i < activeoptions.length; i++) {\n                activeoptions[i].classList.remove('active');\n            }\n            event.target.classList.add('active');\n\n            setUserPreference('local_assessfreq_student_search_table_hoursahead_preference', hours)\n            .then(() => {\n                hoursAhead = hours;\n                getStudentTable(); // Reload the table.\n            })\n            .fail(() => {\n                Notification.exception(new Error('Failed to update user preference: hours ahead'));\n            });\n        }\n    };\n\n    /**\n     * Process the hours behind event from the student table.\n     */\n    const tableSearchBehindSet = function(event) {\n        event.preventDefault();\n        if (event.target.tagName.toLowerCase() === 'a') {\n            let hours = event.target.dataset.metric;\n            let activeoptions = document.getElementById('local-assessfreq-quiz-student-table-hoursbehind')\n            .getElementsByClassName('active');\n\n            // Fix active classes.\n            for (var i = 0; i < activeoptions.length; i++) {\n                activeoptions[i].classList.remove('active');\n            }\n            event.target.classList.add('active');\n\n            setUserPreference('local_assessfreq_student_search_table_hoursbehind_preference', hours)\n            .then(() => {\n                hoursBehind = hours;\n                getStudentTable(); // Reload the table.\n            })\n            .fail(() => {\n                Notification.exception(new Error('Failed to update user preference: hours behind'));\n            });\n        }\n    };\n\n    /**\n     * Process the nav event from the student table.\n     */\n    const tableNav = function(event) {\n        event.preventDefault();\n\n        const linkUrl = new URL(event.target.closest('a').href);\n        const page = linkUrl.searchParams.get('page');\n\n        if (page) {\n            getStudentTable(page);\n        }\n    };\n\n    /**\n     * Re-add event listeners when the student table is updated.\n     */\n    const tableEventListeners = function() {\n        const tableElement = document.getElementById('local-assessfreq-student-search');\n        const tableCardElement = document.getElementById('local-assessfreq-student-search-table');\n        const links = tableElement.querySelectorAll('a');\n        const resetlink = tableElement.getElementsByClassName('resettable');\n        const overrideLinks = tableElement.getElementsByClassName('action-icon override');\n        const disabledLinks = tableElement.getElementsByClassName('action-icon disabled');\n        const tableNavElement = tableCardElement.querySelectorAll('nav'); // There are two nav paging elements per table.\n\n        for (let i = 0; i < links.length; i++) {\n            let linkUrl = new URL(links[i].href);\n            if (linkUrl.search.indexOf('thide') !== -1 || linkUrl.search.indexOf('tshow') !== -1) {\n                links[i].addEventListener('click', tableHide);\n            } else if (linkUrl.search.indexOf('tsort') !== -1) {\n                links[i].addEventListener('click', tableSort);\n            }\n\n        }\n\n        if (resetlink.length > 0) {\n            resetlink[0].addEventListener('click', tableReset);\n        }\n\n        for (let i = 0; i < overrideLinks.length; i++) {\n            overrideLinks[i].addEventListener('click', triggerOverrideModal);\n        }\n\n        for (let i = 0; i < disabledLinks.length; i++) {\n            disabledLinks[i].addEventListener('click', (event) => {\n                event.preventDefault();\n            });\n        }\n\n        tableNavElement.forEach((navElement) => {\n            navElement.addEventListener('click', tableNav);\n        });\n    };\n\n    /**\n     * Display the table that contains all the students that have exams.\n     */\n    const getStudentTable = function(page) {\n        if (typeof page === \"undefined\" || overridden == true) {\n            page = 0;\n        }\n\n        overridden = false;\n\n        let search = document.getElementById('local-assessfreq-quiz-student-table-search').value.trim();\n        let tableElement = document.getElementById('local-assessfreq-student-search-table');\n        let spinner = tableElement.getElementsByClassName('overlay-icon-container')[0];\n        let tableBody = tableElement.getElementsByClassName('table-body')[0];\n\n        let params = {'data': JSON.stringify(\n                    {'search': search, 'page': page, 'hoursahead': hoursAhead, 'hoursbehind': hoursBehind}\n                )};\n\n        spinner.classList.remove('hide'); // Show spinner if not already shown.\n\n        Fragment.loadFragment('local_assessfreq', 'get_student_search_table', contextid, params)\n        .done((response) => {\n            tableBody.innerHTML = response;\n            spinner.classList.add('hide');\n            refreshCounter();\n            tableEventListeners(); // Re-add table event listeners.\n\n        }).fail(() => {\n            Notification.exception(new Error('Failed to update table.'));\n        });\n    };\n\n    /**\n     * Handle processing of refresh and period button actions.\n     */\n    const refreshAction = function(event) {\n        event.preventDefault();\n        var element = event.target;\n\n        if (element.closest('button') !== null && element.closest('button').id == 'local-assessfreq-refresh-quiz-dashboard') {\n            refreshCounter(true);\n            getStudentTable();\n        } else if (element.tagName.toLowerCase() === 'a') {\n            let refreshElement = document.getElementById('local-assessfreq-period-container');\n            let actionButton = refreshElement.getElementsByClassName('dropdown-toggle')[0];\n            actionButton.textContent = element.innerHTML;\n\n            let activeoptions = refreshElement.getElementsByClassName('active');\n\n            // Fix active classes.\n            for (var i = 0; i < activeoptions.length; i++) {\n                activeoptions[i].classList.remove('active');\n            }\n            element.classList.add('active');\n\n            refreshPeriod = element.dataset.period;\n            refreshCounter(true);\n            setUserPreference('local_assessfreq_quiz_refresh_preference', refreshPeriod);\n        }\n    };\n\n    /**\n     * Trigger the override modal form. Thin wrapper to add extra data to click event.\n     */\n    const triggerOverrideModal = function(event) {\n        event.preventDefault();\n        let elements = event.target.closest('a').id.split('-');\n        const quizId = elements.pop();\n        const userid = elements.pop();\n        overridden = true;\n\n        OverrideModal.displayModalForm(quizId, userid);\n    };\n\n    /**\n     * Initialise method for student search.\n     *\n     * @param {integer} context The current context id.\n     */\n    StudentSearch.init = function(context) {\n        contextid = context;\n        OverrideModal.init(context, getStudentTable);\n\n        // Add required initial event listeners.\n        let tableSearchInputElement = document.getElementById('local-assessfreq-quiz-student-table-search');\n        let tableSearchResetElement = document.getElementById('local-assessfreq-quiz-student-table-search-reset');\n        let tableSearchRowsElement = document.getElementById('local-assessfreq-quiz-student-table-rows');\n        let tableSearchAheadElement = document.getElementById('local-assessfreq-quiz-student-table-hoursahead');\n        let tableSearchBehindElement = document.getElementById('local-assessfreq-quiz-student-table-hoursbehind');\n        let refreshElement = document.getElementById('local-assessfreq-period-container');\n\n        tableSearchInputElement.addEventListener('keyup', tableSearch);\n        tableSearchInputElement.addEventListener('paste', tableSearch);\n        tableSearchResetElement.addEventListener('click', tableSearchReset);\n        tableSearchRowsElement.addEventListener('click', tableSearchRowSet);\n        tableSearchAheadElement.addEventListener('click', tableSearchAheadSet);\n        tableSearchBehindElement.addEventListener('click', tableSearchBehindSet);\n        refreshElement.addEventListener('click', refreshAction);\n\n        // Render the student search table.\n        getStudentTable();\n    };\n\n    return StudentSearch;\n});\n"],"file":"student_search.min.js"}