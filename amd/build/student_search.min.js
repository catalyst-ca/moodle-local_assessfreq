define ("local_assessfreq/student_search",["core/ajax","core/fragment","core/notification","local_assessfreq/override_modal"],function(a,b,c,d){var e={},f,g=!1,h=4,i=1,j=60,k,l=function(b,c){return a.call([{methodname:"core_user_update_user_preferences",args:{preferences:[{type:b,value:c}]}}])[0]},m=function(a){var b=document.getElementById("local-assessfreq-period-progress");if(!0==a){clearInterval(k);k=null;b.setAttribute("style","width: 100%");b.setAttribute("aria-valuenow",100)}if(k){return}k=setInterval(function(){var a=b.getAttribute("aria-valuenow"),c=100/j;if(0<a-c){b.setAttribute("style","width: "+(a-c)+"%");b.setAttribute("aria-valuenow",a-c)}else{clearInterval(k);k=null;b.setAttribute("style","width: 100%");b.setAttribute("aria-valuenow",100);x();m()}},1e3)},n=function(b){b.preventDefault();var c={},d=new URL(b.target.closest("a").href),e=d.searchParams.get("tsort"),f=d.searchParams.get("tdir");if(""===f){f="4"}c[e]=f;a.call([{methodname:"local_assessfreq_set_table_preference",args:{tableid:"local_assessfreq_student_search_table",preference:"sortby",values:JSON.stringify(c)}}])[0].then(function(){x()})},o=function(b){b.preventDefault();var c={},d=new URL(b.target.closest("a").href),e=document.getElementById("local-assessfreq-student-search"),f=e.querySelectorAll("a"),g,h,j,k;if(-1!==d.search.indexOf("thide")){g="hide";h=d.searchParams.get("thide")}else{g="show";h=d.searchParams.get("tshow")}for(var l=0,i;l<f.length;l++){i=new URL(f[l].href);if(-1!==i.search.indexOf("thide")){j="hide";k=i.searchParams.get("thide")}else{j="show";k=i.searchParams.get("tshow")}if("show"===j){c[k]=1}}c[h]="hide"===g?1:0;a.call([{methodname:"local_assessfreq_set_table_preference",args:{tableid:"local_assessfreq_student_search_table",preference:"collapse",values:JSON.stringify(c)}}])[0].then(function(){x()})},p=function(b){b.preventDefault();a.call([{methodname:"local_assessfreq_set_table_preference",args:{tableid:"local_assessfreq_student_search_table",preference:"reset",values:JSON.stringify({})}}])[0].then(function(){x()})},q=function(a){if(2<a.target.value.length){x()}if(0==a.target.value.length){x()}},r=function(){var a=document.getElementById("local-assessfreq-quiz-student-table-search");a.value="";a.focus();x()},s=function(a){a.preventDefault();if("a"===a.target.tagName.toLowerCase()){for(var b=a.target.dataset.metric,d=document.getElementById("local-assessfreq-quiz-student-table-rows").getElementsByClassName("active"),e=0;e<d.length;e++){d[e].classList.remove("active")}a.target.classList.add("active");l("local_assessfreq_student_search_table_rows_preference",b).then(function(){x()}).fail(function(){c.exception(new Error("Failed to update user preference: rows"))})}},t=function(a){a.preventDefault();if("a"===a.target.tagName.toLowerCase()){for(var b=a.target.dataset.metric,d=document.getElementById("local-assessfreq-quiz-student-table-hoursahead").getElementsByClassName("active"),e=0;e<d.length;e++){d[e].classList.remove("active")}a.target.classList.add("active");l("local_assessfreq_student_search_table_hoursahead_preference",b).then(function(){h=b;x()}).fail(function(){c.exception(new Error("Failed to update user preference: hours ahead"))})}},u=function(a){a.preventDefault();if("a"===a.target.tagName.toLowerCase()){for(var b=a.target.dataset.metric,d=document.getElementById("local-assessfreq-quiz-student-table-hoursbehind").getElementsByClassName("active"),e=0;e<d.length;e++){d[e].classList.remove("active")}a.target.classList.add("active");l("local_assessfreq_student_search_table_hoursbehind_preference",b).then(function(){i=b;x()}).fail(function(){c.exception(new Error("Failed to update user preference: hours behind"))})}},v=function(a){a.preventDefault();var b=new URL(a.target.closest("a").href),c=b.searchParams.get("page");if(c){x(c)}},w=function(){for(var a=document.getElementById("local-assessfreq-student-search"),b=document.getElementById("local-assessfreq-student-search-table"),c=a.querySelectorAll("a"),d=a.getElementsByClassName("resettable"),e=a.getElementsByClassName("action-icon override"),f=a.getElementsByClassName("action-icon disabled"),g=b.querySelectorAll("nav"),h=0,j;h<c.length;h++){j=new URL(c[h].href);if(-1!==j.search.indexOf("thide")||-1!==j.search.indexOf("tshow")){c[h].addEventListener("click",o)}else if(-1!==j.search.indexOf("tsort")){c[h].addEventListener("click",n)}}if(0<d.length){d[0].addEventListener("click",p)}for(var k=0;k<e.length;k++){e[k].addEventListener("click",z)}for(var l=0;l<f.length;l++){f[l].addEventListener("click",function(a){a.preventDefault()})}g.forEach(function(a){a.addEventListener("click",v)})},x=function(a){if("undefined"==typeof a||!0==g){a=0}g=!1;var d=document.getElementById("local-assessfreq-quiz-student-table-search").value.trim(),e=document.getElementById("local-assessfreq-student-search-table"),j=e.getElementsByClassName("overlay-icon-container")[0],k=e.getElementsByClassName("table-body")[0],l={data:JSON.stringify({search:d,page:a,hoursahead:h,hoursbehind:i})};j.classList.remove("hide");b.loadFragment("local_assessfreq","get_student_search_table",f,l).done(function(a){k.innerHTML=a;j.classList.add("hide");m();w()}).fail(function(){c.exception(new Error("Failed to update table."))})},y=function(a){a.preventDefault();var b=a.target;if(null!==b.closest("button")&&"local-assessfreq-refresh-quiz-dashboard"==b.closest("button").id){m(!0);x()}else if("a"===b.tagName.toLowerCase()){var c=document.getElementById("local-assessfreq-period-container"),d=c.getElementsByClassName("dropdown-toggle")[0];d.textContent=b.innerHTML;for(var e=c.getElementsByClassName("active"),f=0;f<e.length;f++){e[f].classList.remove("active")}b.classList.add("active");j=b.dataset.period;m(!0);l("local_assessfreq_quiz_refresh_preference",j)}},z=function(a){a.preventDefault();var b=a.target.closest("a").id.split("-"),c=b.pop(),e=b.pop();g=!0;d.displayModalForm(c,e)};e.init=function(a){f=a;d.init(a,x);var b=document.getElementById("local-assessfreq-quiz-student-table-search"),c=document.getElementById("local-assessfreq-quiz-student-table-search-reset"),e=document.getElementById("local-assessfreq-quiz-student-table-rows"),g=document.getElementById("local-assessfreq-quiz-student-table-hoursbehind"),h=document.getElementById("local-assessfreq-quiz-student-table-hoursahead"),i=document.getElementById("local-assessfreq-period-container");b.addEventListener("keyup",q);b.addEventListener("paste",q);c.addEventListener("click",r);e.addEventListener("click",s);g.addEventListener("click",t);h.addEventListener("click",u);i.addEventListener("click",y);x()};return e});
//# sourceMappingURL=student_search.min.js.map
