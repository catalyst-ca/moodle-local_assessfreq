define ("local_assessfreq/calendar",["core/str","core/notification","core/ajax"],function(a,b,c){var d={},e=[],f=[{key:"sun",component:"calendar"},{key:"mon",component:"calendar"},{key:"tue",component:"calendar"},{key:"wed",component:"calendar"},{key:"thu",component:"calendar"},{key:"fri",component:"calendar"},{key:"sat",component:"calendar"},{key:"jan",component:"local_assessfreq"},{key:"feb",component:"local_assessfreq"},{key:"mar",component:"local_assessfreq"},{key:"apr",component:"local_assessfreq"},{key:"may",component:"local_assessfreq"},{key:"jun",component:"local_assessfreq"},{key:"jul",component:"local_assessfreq"},{key:"aug",component:"local_assessfreq"},{key:"sep",component:"local_assessfreq"},{key:"oct",component:"local_assessfreq"},{key:"nov",component:"local_assessfreq"},{key:"dec",component:"local_assessfreq"}],g,h=new Date,k=function(a,b){return 32-new Date(b,a,32).getDate()},l=function(a){var b=a.year,d=a.metric,f=a.modules;return new Promise(function(a,g){var h=JSON.stringify({year:b,metric:d,modules:f});c.call([{methodname:"local_assessfreq_get_frequency",args:{jsondata:h}}])[0].done(function(b){e=JSON.parse(b);a(e)}).fail(function(){g(new Error("Failed to get events"))})})},m=function(a,b){var c;if("undefined"!=typeof e[a]&&"undefined"!=typeof e[a][b]){c=e[a][b]}return c},n=function(a){var b=a.year,c=a.startMonth,d=a.endMonth;return new Promise(function(a,e){for(var f=document.createElement("div"),h=c,k=c,l;k<=d;k++){l=document.createElement("div");l.classList.add("local-assessfreq-month");var m=document.createElement("table"),n=document.createElement("thead"),o=document.createElement("tbody");o.id="calendar-body-"+k;var p=document.createElement("tr"),q=document.createElement("tr"),r=document.createElement("th");r.colSpan=7;r.innerHTML=g[7+h];for(var s=0,j;7>s;s++){j=document.createElement("th");j.innerHTML=g[s];q.appendChild(j)}p.appendChild(r);n.appendChild(p);n.appendChild(q);m.appendChild(n);m.appendChild(o);l.appendChild(m);f.appendChild(l);h++}if("undefined"==typeof b||"undefined"==typeof c||"undefined"==typeof d){e(Error("Failed to create calendar tables."))}else{a({calendarContainer:f,year:b,startMonth:c})}})},o=function(a,b,c){for(var d=new Date(b,c).getDay(),e=m(b,c+1),f=1,g=0,l;6>g;g++){l=document.createElement("tr");for(var q=0;7>q;q++){if(0===g&&q<d){var n=document.createElement("td"),o=document.createTextNode("");n.appendChild(o);l.appendChild(n)}else if(f>k(c,b)){break}else{n=document.createElement("td");o=document.createTextNode(f);if("undefined"!=typeof e&&e.hasOwnProperty(f)){var p="local-assessfreq-heat-"+e[f].heat;n.classList.add(p)}if(f===h.getDate()&&parseInt(b)===h.getFullYear()&&parseInt(c)===h.getMonth()){n.classList.add("bg-info")}n.appendChild(o);l.appendChild(n);f++}}a.appendChild(l)}},p=function(a){var b=a.calendarContainer,c=a.year,d=a.startMonth;return new Promise(function(a,e){for(var f=b.getElementsByTagName("tbody"),g=d,h=0,j;h<f.length;h++){j=f[h];o(j,c,g);g++}if("undefined"==typeof b){e(Error("Failed to populate calendar tables."))}else{a(b)}})};d.generate=function(c,d,e,h,i){return new Promise(function(j,k){var m={year:c,startMonth:d,endMonth:e},o={year:c,metric:h,modules:i};a.get_strings(f).catch(function(){b.exception(new Error("Failed to load strings"))}).then(function(a){g=a;return o}).then(l).then(function(){return m}).then(n).then(p).then(function(a){if("undefined"!=typeof a){j(a)}else{k(Error("Could not generate calendar"))}})})};return d});
//# sourceMappingURL=calendar.min.js.map
