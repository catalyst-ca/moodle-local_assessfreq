define ("local_assessfreq/calendar",["core/str","core/notification","core/ajax"],function(a,b,c){var d={},e=[],f=[{key:"sun",component:"calendar"},{key:"mon",component:"calendar"},{key:"tue",component:"calendar"},{key:"wed",component:"calendar"},{key:"thu",component:"calendar"},{key:"fri",component:"calendar"},{key:"sat",component:"calendar"},{key:"jan",component:"local_assessfreq"},{key:"feb",component:"local_assessfreq"},{key:"mar",component:"local_assessfreq"},{key:"apr",component:"local_assessfreq"},{key:"may",component:"local_assessfreq"},{key:"jun",component:"local_assessfreq"},{key:"jul",component:"local_assessfreq"},{key:"aug",component:"local_assessfreq"},{key:"sep",component:"local_assessfreq"},{key:"oct",component:"local_assessfreq"},{key:"nov",component:"local_assessfreq"},{key:"dec",component:"local_assessfreq"}],g,h=new Date,k=function(a,b){return 32-new Date(b,a,32).getDate()},l=function(a,b,d){return new Promise(function(f,g){var h={year:a,metric:b,modules:d};window.console.log(h);var i=JSON.stringify(h);c.call([{methodname:"local_assessfreq_get_frequency",args:{jsondata:i}}])[0].done(function(a){e=JSON.parse(a);f(e)}).fail(function(){g(new Error("Failed to get events"))})})},m=function(a){var b=a.year,c=a.startMonth,d=a.endMonth;return new Promise(function(a,e){for(var f=document.createElement("div"),h=c,k=c,l;k<=d;k++){l=document.createElement("div");l.classList.add("local-assessfreq-month");var m=document.createElement("table"),n=document.createElement("thead"),o=document.createElement("tbody");o.id="calendar-body-"+k;var p=document.createElement("tr"),q=document.createElement("tr"),r=document.createElement("th");r.colSpan=7;r.innerHTML=g[7+h];for(var s=0,j;7>s;s++){j=document.createElement("th");j.innerHTML=g[s];q.appendChild(j)}p.appendChild(r);n.appendChild(p);n.appendChild(q);m.appendChild(n);m.appendChild(o);l.appendChild(m);f.appendChild(l);h++}if("undefined"==typeof b||"undefined"==typeof c||"undefined"==typeof d){e(Error("Failed to create calendar tables."))}else{a({calendarContainer:f,year:b,startMonth:c})}})},n=function(a,b,c){for(var d=new Date(b,c).getDay(),e=1,f=0,g;6>f;f++){g=document.createElement("tr");for(var n=0;7>n;n++){if(0===f&&n<d){var l=document.createElement("td"),m=document.createTextNode("");l.appendChild(m);g.appendChild(l)}else if(e>k(c,b)){break}else{l=document.createElement("td");m=document.createTextNode(e);if(e===h.getDate()&&parseInt(b)===h.getFullYear()&&parseInt(c)===h.getMonth()){l.classList.add("bg-info")}l.appendChild(m);g.appendChild(l);e++}}a.appendChild(g)}},o=function(a){var b=a.calendarContainer,c=a.year,d=a.startMonth;return new Promise(function(a,e){for(var f=b.getElementsByTagName("tbody"),g=d,h=0,j;h<f.length;h++){j=f[h];n(j,c,g);g++}if("undefined"==typeof b){e(Error("Failed to populate calendar tables."))}else{a(b)}})};d.generate=function(c,d,h,i,j){return new Promise(function(k,n){var p={year:c,startMonth:d,endMonth:h};a.get_strings(f).catch(function(){b.exception(new Error("Failed to load strings"))}).then(function(a){g=a}).then(l(c,i,j)).then(function(){window.console.log(e);return p}).then(m).then(o).then(function(a){if("undefined"!=typeof a){k(a)}else{n(Error("Could not generate calendar"))}})})};return d});
//# sourceMappingURL=calendar.min.js.map
