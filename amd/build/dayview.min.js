define ("local_assessfreq/dayview",["core/str","core/notification","core/modal_factory","local_assessfreq/modal_large","core/templates","core/ajax"],function(a,b,c,d,e,f){var g={},h,i="<p class=\"text-center\"><i class=\"fa fa-circle-o-notch fa-spin fa-3x fa-fw\"></i></p>",j=[{key:"sun",component:"calendar"},{key:"mon",component:"calendar"},{key:"tue",component:"calendar"},{key:"wed",component:"calendar"},{key:"thu",component:"calendar"},{key:"fri",component:"calendar"},{key:"sat",component:"calendar"},{key:"jan",component:"local_assessfreq"},{key:"feb",component:"local_assessfreq"},{key:"mar",component:"local_assessfreq"},{key:"apr",component:"local_assessfreq"},{key:"may",component:"local_assessfreq"},{key:"jun",component:"local_assessfreq"},{key:"jul",component:"local_assessfreq"},{key:"aug",component:"local_assessfreq"},{key:"sep",component:"local_assessfreq"},{key:"oct",component:"local_assessfreq"},{key:"nov",component:"local_assessfreq"},{key:"dec",component:"local_assessfreq"}],k,l=function(a,b){return new Promise(function(c){var d=new Date(1e3*a),e=d.getFullYear(),f=k[7+d.getMonth()],g=d.getDate(),h=d.getHours(),i="0"+d.getMinutes(),j=h+":"+i.substr(-2);if("strftimetime"===b){c(j)}else{c(g+" "+f+" "+e+", "+j)}})},m=function(a){var b=JSON.parse(a);return new Promise(function(a){for(var c=[],d=5/72,e=function(a){var e=[],f=b[a].endyear,g=b[a].endmonth-1,h=b[a].endday,i=new Date(f,g,h).getTime()/1e3,j=b[a].timestart-i,k=0,m=0;if(0>=j){j=0;m=(b[a].timeend-i)/60*d;var o=l(b[a].timestart,"strftimedatetime");c.push(o);e.push(o)}else{k=j/60*d;m=(b[a].timeend-b[a].timestart)/60*d;var p=l(b[a].timestart,"strftimetime");c.push(p);e.push(p)}if(100<k+m){m=100-k}b[a].leftmargin=k;b[a].width=m;var n=l(b[a].timeend,"strftimetime");c.push(n);e.push(n);Promise.all(e).then(function(c){b[a].start=c[0];b[a].end=c[1]})},f=0;f<b.length;f++){e(f)}Promise.all(c).then(function(){a(b)})})};g.display=function(a){h.setBody(i);h.show();var c=JSON.stringify({date:a,modules:["all"]});f.call([{methodname:"local_assessfreq_get_day_events",args:{jsondata:c}}])[0].then(m).then(function(a){h.setBody(e.render("local_assessfreq/dayview",{rows:a}))}).fail(function(){b.exception(new Error("Failed to load day view"))})};g.init=function(){a.get_strings(j).catch(function(){b.exception(new Error("Failed to load strings"))}).then(function(a){k=a});a.get_string("schedule","local_assessfreq").then(function(a){c.create({type:d.TYPE,title:a,body:i}).done(function(a){h=a})}).catch(function(){b.exception(new Error("Failed to load string: loading"))})};return g});
//# sourceMappingURL=dayview.min.js.map
