function asyncGeneratorStep(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function _asyncToGenerator(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var h=a.apply(b,c);function f(a){asyncGeneratorStep(h,d,e,f,g,"next",a)}function g(a){asyncGeneratorStep(h,d,e,f,g,"throw",a)}f(void 0)})}}define ("local_assessfreq/dayview",["core/str","core/notification","core/modal_factory","local_assessfreq/modal_large","core/templates","core/ajax","core/user_date"],function(a,b,c,d,e,f,g){var h={},i,j=function(c,d){return new Promise(function(e){a.get_string(d,"langconfig").then(function(a){g.get([{timestamp:c,format:a}]).then(function(a){e(a)})}).catch(function(){b.exception(new Error("Failed to load string: date format"))})})},k=function(){var a=_asyncToGenerator(regeneratorRuntime.mark(function a(b){var c,d,e,f,g,h,k,l,m,n;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:c=JSON.parse(b);d=5/72;e=0;case 3:if(!(e<c.length)){a.next=34;break}f=c[e].endyear;g=c[e].endmonth-1;h=c[e].endday;k=new Date(f,g,h).getTime()/1e3;l=c[e].timestart-k;m=0;n=0;if(!(0>=l)){a.next=19;break}l=0;n=(c[e].timeend-k)/60*d;a.next=16;return j(c[e].timestart,"strftimedatetime");case 16:c[e].start=a.sent;a.next=24;break;case 19:m=l/60*d;n=(c[e].timeend-c[e].timestart)/60*d;a.next=23;return j(c[e].timestart,"strftimetime");case 23:c[e].start=a.sent;case 24:if(100<m+n){n=100-m}c[e].leftmargin=m;c[e].width=n;a.next=29;return j(c[e].timeend,"strftimetime");case 29:c[e].end=a.sent;window.console.log(c[e]);case 31:e++;a.next=3;break;case 34:return a.abrupt("return",new Promise(function(a){a(c)}));case 35:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}();h.display=function(a){var c=JSON.stringify({date:a,modules:["all"]});f.call([{methodname:"local_assessfreq_get_day_events",args:{jsondata:c}}])[0].then(k).then(function(a){i.setBody(e.render("local_assessfreq/dayview",{rows:a}));i.show()}).fail(function(){b.exception(new Error("Failed to load day view"))});i.setBody(e.render("local_assessfreq/dayview",{}));i.show()};h.init=function(){a.get_string("schedule","local_assessfreq").then(function(a){c.create({type:d.TYPE,title:a,body:"<p class=\"text-center\"><i class=\"fa fa-spinner fa-pulse fa-2x fa-fw\"></i></p>"}).done(function(a){i=a})}).catch(function(){b.exception(new Error("Failed to load string: loading"))})};return h});
//# sourceMappingURL=dayview.min.js.map
