function asyncGeneratorStep(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function _asyncToGenerator(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var h=a.apply(b,c);function f(a){asyncGeneratorStep(h,d,e,f,g,"next",a)}function g(a){asyncGeneratorStep(h,d,e,f,g,"throw",a)}f(void 0)})}}define ("local_assessfreq/dayview",["core/str","core/notification","core/modal_factory","local_assessfreq/modal_large","core/templates","core/ajax"],function(a,b,c,d,e,f){var g={},h,i="<p class=\"text-center\"><i class=\"fa fa-circle-o-notch fa-spin fa-3x fa-fw\"></i></p>",j=[{key:"sun",component:"calendar"},{key:"mon",component:"calendar"},{key:"tue",component:"calendar"},{key:"wed",component:"calendar"},{key:"thu",component:"calendar"},{key:"fri",component:"calendar"},{key:"sat",component:"calendar"},{key:"jan",component:"local_assessfreq"},{key:"feb",component:"local_assessfreq"},{key:"mar",component:"local_assessfreq"},{key:"apr",component:"local_assessfreq"},{key:"may",component:"local_assessfreq"},{key:"jun",component:"local_assessfreq"},{key:"jul",component:"local_assessfreq"},{key:"aug",component:"local_assessfreq"},{key:"sep",component:"local_assessfreq"},{key:"oct",component:"local_assessfreq"},{key:"nov",component:"local_assessfreq"},{key:"dec",component:"local_assessfreq"}],k,l=function(a,b){return new Promise(function(c){var d=new Date(1e3*a),e=d.getFullYear(),f=k[7+d.getMonth()],g=d.getDate(),h=d.getHours(),i="0"+d.getMinutes(),j=h+":"+i.substr(-2);if("strftimetime"===b){c(j)}else{c(g+" "+f+" "+e+", "+j)}})},m=function(){var a=_asyncToGenerator(regeneratorRuntime.mark(function a(b){var c,d,e,f,g,h,j,k,m,n;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:c=JSON.parse(b);d=5/72;e=0;case 3:if(!(e<c.length)){a.next=33;break}f=c[e].endyear;g=c[e].endmonth-1;h=c[e].endday;j=new Date(f,g,h).getTime()/1e3;k=c[e].timestart-j;m=0;n=0;if(!(0>=k)){a.next=19;break}k=0;n=(c[e].timeend-j)/60*d;a.next=16;return l(c[e].timestart,"strftimedatetime");case 16:c[e].start=a.sent;a.next=24;break;case 19:m=k/60*d;n=(c[e].timeend-c[e].timestart)/60*d;a.next=23;return l(c[e].timestart,"strftimetime");case 23:c[e].start=a.sent;case 24:if(100<m+n){n=100-m}c[e].leftmargin=m;c[e].width=n;a.next=29;return l(c[e].timeend,"strftimetime");case 29:c[e].end=a.sent;case 30:e++;a.next=3;break;case 33:return a.abrupt("return",new Promise(function(a){a(c)}));case 34:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}();g.display=function(a){h.setBody(i);h.show();var c=JSON.stringify({date:a,modules:["all"]});f.call([{methodname:"local_assessfreq_get_day_events",args:{jsondata:c}}])[0].then(m).then(function(a){h.setBody(e.render("local_assessfreq/dayview",{rows:a}))}).fail(function(){b.exception(new Error("Failed to load day view"))})};g.init=function(){a.get_strings(j).catch(function(){b.exception(new Error("Failed to load strings"))}).then(function(a){k=a});a.get_string("schedule","local_assessfreq").then(function(a){c.create({type:d.TYPE,title:a,body:i}).done(function(a){h=a})}).catch(function(){b.exception(new Error("Failed to load string: loading"))})};return g});
//# sourceMappingURL=dayview.min.js.map
