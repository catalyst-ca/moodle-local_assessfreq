define ("local_assessfreq/reportcard",["core/fragment","core/templates","core/notification","core/ajax"],function(a,b,c,d){var l={},m,n,o,p,q=[{cardId:"local-assessfreq-assess-due-month",call:"assess_by_month"},{cardId:"local-assessfreq-assess-by-activity",call:"assess_by_activity"},{cardId:"local-assessfreq-assess-due-month-student",call:"assess_by_month_student"}];function e(a,b){d.call([{methodname:"core_user_update_user_preferences",args:{preferences:[{type:a,value:b}]}}])[0].fail(function(){c.exception(new Error("Failed to update user preference"))})}function f(){q.forEach(function(d){var e=document.getElementById(d.cardId),f=e.getElementsByClassName("overlay-icon-container")[0],g=e.getElementsByClassName("chart-body")[0],h={data:JSON.stringify({year:n,call:d.call})};f.classList.remove("hide");a.loadFragment("local_assessfreq","get_chart",m,h).done(function(a){b.render("core/chart",{withtable:!0,chartdata:a}).done(function(a,c){f.classList.add("hide");b.replaceNodeContents(g,a,c)}).fail(function(){c.exception(new Error("Failed to load chart template."))})}).fail(function(){c.exception(new Error("Failed to load card year filter"))})})}function g(a){var b=a.target;if("a"===b.tagName.toLowerCase()&&b.dataset.year!=n){n=b.dataset.year;e("local_assessfreq_overview_year_preference",n);var c=document.getElementById("local-assessfreq-report-overview").getElementsByClassName("local-assessfreq-year")[0];c.innerHTML=n;f()}}function h(a){var b=a.target;if("a"===b.tagName.toLowerCase()&&b.dataset.year!=o){o=b.dataset.year;e("local_assessfreq_heatmap_year_preference",o);var c=document.getElementById("local-assessfreq-report-heatmap").getElementsByClassName("local-assessfreq-year")[0];c.innerHTML=o;window.console.log("TODO: load heatmap")}}function i(a){var b=a.target;if("a"===b.tagName.toLowerCase()&&b.dataset.metric!=p){p=b.dataset.metric;e("local_assessfreq_heatmap_metric_preference",p);window.console.log("TODO: load heatmap")}}function j(){window.console.log("updating heatmap")}function k(a){var b=a.getElementsByTagName("a"),c=b[0],d=!0,e=!1,f=void 0;try{for(var g=b[Symbol.iterator](),h;!(d=(h=g.next()).done);d=!0){var i=h.value,k=i.dataset.module;if("all"===k.toLowerCase()){i.addEventListener("click",function(a){a.preventDefault();var c=!0,d=!1,e=void 0;try{for(var f=b[Symbol.iterator](),g,h;!(c=(g=f.next()).done);c=!0){h=g.value;h.classList.remove("active")}}catch(a){d=!0;e=a}finally{try{if(!c&&null!=f.return){f.return()}}finally{if(d){throw e}}}j(b)})}else if("close"===k.toLowerCase()){i.addEventListener("click",function(a){a.preventDefault();a.stopPropagation();var c=document.getElementById("local-assessfreq-heatmap-modules-filter");c.classList.remove("show");j(b)})}else{i.addEventListener("click",function(a){a.preventDefault();a.stopPropagation();c.classList.remove("active");a.target.classList.toggle("active");j(b)})}}}catch(a){e=!0;f=a}finally{try{if(!d&&null!=g.return){g.return()}}finally{if(e){throw f}}}}l.init=function(a){m=a;var b=document.getElementById("local-assessfreq-cards-year");n=b.getElementsByClassName("active")[0].dataset.year;b.addEventListener("click",g);var c=document.getElementById("local-assessfreq-heatmap-year");o=c.getElementsByClassName("active")[0].dataset.year;c.addEventListener("click",h);var d=document.getElementById("local-assessfreq-heatmap-metrics");p=d.getElementsByClassName("active")[0].dataset.metric;d.addEventListener("click",i);var e=document.getElementById("local-assessfreq-heatmap-modules");k(e);f()};return l});
//# sourceMappingURL=reportcard.min.js.map
